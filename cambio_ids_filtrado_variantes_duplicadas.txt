##se crean archivos binarios
cd ~/analisis_asociacion/adultos_mega/
genos=fuentes/U16_010_888_Cluster_MEGA_Global/U16_010_888_Cluster_MEGA_Global
##cambiamos los nombres

plink --file $genos --update-name ../ni침os/ni침os/fuentes/Multi-EthnicGlobal_B1_b144_rsids.txt --chr-set 22 --make-bed --out calidad/cluster3/primeros_adultos

genos=calidad/cluster3/primeros_adultos

##identificaci칩n de variantes duplicadas es exageradamente tardado en BASH. Nos mudamos a R.
R
carpeta <- "calidad/cluster3"
estudio <- "primeros_adultos"
snp <- read.table(paste0(carpeta, "/",  estudio, ".bim"))
chr_pos <- snp[,c(1,4)]
dobles <- snp[duplicated(chr_pos),2]
dobles <- dobles[which(dobles!=levels(dobles)[1])]
dobles <- droplevels(dobles)
write.table(dobles, "listas/eliminacion_QC/SNP_duplicados.list", row.names=FALSE, col.names=FALSE, quote=FALSE)
q()
paste listas/eliminacion_QC/SNP_duplicados.list <(awk '$1=$1".dup"' listas/eliminacion_QC/SNP_duplicados.list) > temp.txt
mv temp.txt listas/eliminacion_QC/SNP_duplicados.list
plink --bfile $genos --update-name listas/eliminacion_QC/SNP_duplicados.list --make-bed --out $genos

##agregamos sexos, ver gui칩n agregar_genero.R
plink --bfile $genos --update-sex listas/integrar_sexos.txt --make-bed --out calidad/cluster2/terceros_adultos

##agregamos estado de caso y control
awk -i inplace '$2~/GC/ || $2~/ICN/ {$6=1} 1' calidad/cluster2/primeros_adultos.fam
awk -i inplace '$2~/SOL/ || $2~/RED/ || $2~/CON/ || $2~/TER/ || $2~/MZ1/ {$6=2} 1' calidad/cluster2/primeros_adultos.fam
