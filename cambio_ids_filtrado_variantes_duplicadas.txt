##se crean archivos binarios
cd ~/analisis_asociacion/adultos_mega/
##genos=fuentes/U16_010_888_Cluster_MEGA_Global/U16_010_888_Cluster_MEGA_Global
##genos=fuentes/U17_047_MEGAGlobal_ClusterMEGAGlobal_09Ago17/GenomeStudio/PLINK/PLINK_090817_0823/PLINK
##genos=fuentes/U17_047_Canizales_28Jun2018/PLINK_260618_1103/Resultados
##genos=fuentes/MP_RL_GCVE_15_Placas/PLINK_15Placas_23062016/PLINK_230616_0737/PLINK_15Placas_23062016
genos=fuentes/MP_RL_GCVE_14Placas_ClusterFile/PLINK/PLINK_040816_0811/PLINK

plink --file $genos --list-duplicate-vars ids-only suppress-first --make-bed --out calidad/cluster3/adultos_cero
genos=calidad/cluster3/adultos_cero
diff -y <(cut -f2 -d " " calidad/cluster3/primeros_adultos.fam|sort) <(cut -f2 -d " " $genos.fam | sort) | grep -v -e "|" -e "<"
plink --bfile $genos --exclude $genos.dupvar --make-bed --out $genos
echo . > prueba.txt
plink --bfile $genos --exclude prueba.txt --make-bed --out $genos
rm prueba.txt

##identificación de variantes duplicadas es exageradamente tardado en BASH. Nos mudamos a R.
Rscript ~/repos/gwas_inicio_fin/sitios_dup_fam.R $genos.bim
paste listas/eliminacion_QC/SNP_duplicados.list <(awk '$1=$1".dup"' listas/eliminacion_QC/SNP_duplicados.list) > temp.txt
mv temp.txt listas/eliminacion_QC/SNP_duplicados.list
plink --bfile $genos --update-name listas/eliminacion_QC/SNP_duplicados.list --make-bed --out $genos
plink --bfile $genos --exclude <(cut -f2 listas/eliminacion_QC/SNP_duplicados.list) --make-bed --out $genos
##cambiamos los nombres
plink --bfile $genos --update-name ../niños/niños/fuentes/Multi-EthnicGlobal_B1_b144_rsids.txt --make-bed --out $genos
rm calidad/cluster3/*~
