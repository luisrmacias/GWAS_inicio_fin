##se crean archivos binarios
cd ~/analisis_asociacion/adultos_mega/
carpeta=calidad/cluster3/mitocondriales
genotipos="$(ls fuentes/condensado | sed 's/.\{4\}$//' | sort -u)"

proyecto=niños

TEMPFILE=/tmp/$$.tmp
echo 0 > $TEMPFILE

for genos in $genotipos
do
COUNTER=$[$(cat $TEMPFILE) + 1]
plink --file fuentes/condensado/$genos --chr MT --list-duplicate-vars ids-only suppress-first --make-bed --out $carpeta/$proyecto.$COUNTER
plink --bfile $carpeta/$proyecto.$COUNTER --chr MT --exclude $carpeta/$proyecto.$COUNTER.dupvar --make-bed --out $carpeta/$proyecto.$COUNTER
echo $COUNTER > $TEMPFILE
Rscript ~/repos/gwas_inicio_fin/preparacion/sitios_dup_bim.R $carpeta/$proyecto.$COUNTER.bim
paste ~/analisis_asociacion/adultos_mega/listas/eliminacion_QC/SNP_duplicados.list <(awk '$1=$1".dup"' ~/analisis_asociacion/adultos_mega/listas/eliminacion_QC/SNP_duplicados.list) > temp.txt
mv temp.txt listas/eliminacion_QC/SNP_duplicados.list
plink --bfile $carpeta/$proyecto.$COUNTER --update-name listas/eliminacion_QC/SNP_duplicados.list --make-bed --out $carpeta/$proyecto.$COUNTER
plink --bfile $carpeta/$proyecto.$COUNTER --exclude <(cut -f2 listas/eliminacion_QC/SNP_duplicados.list) --make-bed --out $carpeta/$proyecto.$COUNTER
##cambiamos los nombres
plink --bfile $carpeta/$proyecto.$COUNTER --update-name ~/analisis_asociacion/niños/niños/fuentes/Multi-EthnicGlobal_B1_b144_rsids.txt --make-bed --out $carpeta/$proyecto.$COUNTER
rm $carpeta/*~
echo $COUNTER > $TEMPFILE
done
unlink $TEMPFILE

cat > temp.txt
.
^D
for pob in 1 2 3
do
plink --bfile $carpeta/$proyecto.$pob --exclude temp.txt --make-bed --out $carpeta/$proyecto.$pob
done
rm $carpeta/*~
